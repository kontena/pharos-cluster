#!/usr/bin/env ruby
# frozen_string_literal: true

if ARGV.first == 'spec'
  ARGV.shift
  ARGV << 'spec' if ARGV.empty?
  require 'rspec/core'
  RSpec::Core::Runner.invoke
  exit 0
end

# add lib to libpath (only needed when running from the sources)
require 'pathname'
lib_path = File.expand_path('../../lib', Pathname.new(__FILE__).realpath)
$LOAD_PATH.unshift lib_path unless $LOAD_PATH.include?(lib_path)

STDOUT.sync = true

require 'pharos_cluster'
Signal.trap("SIGPIPE", "SYSTEM_DEFAULT")
Pharos::RootCommand.run
